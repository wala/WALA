plugins {
	id 'eclipse'
}

eclipse.project.natures 'org.eclipse.pde.PluginNature'

sourceSets.main.java.srcDirs = ['source/java']

dependencies {
	compile(
		'commons-io:commons-io:2.4',
		project(':com.ibm.wala.core'),
		project(':com.ibm.wala.shrike'),
		project(':com.ibm.wala.util'),
		)
}

javadoc {
	def js = ':com.ibm.wala.cast.js'
	evaluationDependsOn(js)

	dependsOn "$js:compileJava"
	js = project(js)
	doFirst {
		classpath += files js.compileJava
	}

	dependsOn js.createPackageList
	options.linksOffline js.javadoc.outputDirectory.path, js.createPackageList.packageList.parent
}

// TODO: if we eventually stop supporting Maven, then we may be able
// to discard the "copyJarsIntoLib" task and the corresponding lines
// in "META-INF/MANIFEST.MF" and "build.properties"

task copyJarsIntoLib(type: Sync) {
	def commonsIoJar = configurations.runtimeClasspath.files[0]
	assert commonsIoJar.name.startsWith('commons-io-')
	from commonsIoJar
	into 'lib'
}

assemble.dependsOn copyJarsIntoLib
clean.dependsOn cleanCopyJarsIntoLib
